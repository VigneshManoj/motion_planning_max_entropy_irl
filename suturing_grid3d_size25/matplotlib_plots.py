import numpy as np
import matplotlib.pyplot as plt
from mpl_toolkits.mplot3d import Axes3D
import os
# from sklearn.preprocessing import normalize


trajectories_z0 = [[0, 0, 0, 0] for i in range(1331)]
default_points = np.array([-5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5])
i = 0
for z in default_points:
  for y in default_points:
    for x in default_points:
      trajectories_z0[i] = [x, y, z, 0.]
      i += 1


# weights = np.array([ 0.86606,    0.83231,    0.36573,    0.88065,    0.43141,    8.09653,    0.48275,    0.63349,
#                      0.22278,    0.65300,    0.39058,    0.70320,    0.45969,    0.50013,    0.89983,    0.48156,
#                      8.45762,    0.17549,    0.17827,    0.93676,    0.35098,    0.32827,    0.89523,    0.91574,
#                      0.38595,    0.82771,    0.84156,    8.15301,    0.13228,    0.80403,    0.00957,    0.83780,
#                      0.86237,    0.78184,    0.12404,    0.52459,    0.98938,    0.46508,    8.04134,    0.26305,
#                      0.49731,    0.28017,    0.27976,    0.20002,    0.46367,    0.54741,    0.93018,    0.66636,
#                      0.42815,    8.57352,    0.08831,    0.32845,    0.97826,    0.76923,    0.30592,    0.60836,
#                      0.55568,    0.88519,    0.94008,    0.87352,    8.77289,    0.08207,    0.36324,    0.40164,
#                      0.05353,    0.34603,    0.45539,    0.38059,    0.65810,    0.73721,    0.36884,    8.58656,
#                      0.29147,    0.00275,    0.40088,    0.55660,    0.86510,    0.02823,    0.87297,    0.47724,
#                      0.63697,    0.84070,    8.56395,    0.89196,    0.94764,    0.52526,    0.92291,    0.17491,
#                      0.11700,    0.11084,    0.66124,    0.07273,    0.94089,    8.53461,    0.89326,    0.36706,
#                      0.17802,    0.53724,    0.96983,    0.56480,    0.20451,    0.33316,    0.69080,    0.63368,
#                      8.43536,    0.61112,    0.74471,    0.78599,    0.18430,    0.58020,    0.18954,    0.60108,
#                      0.94191,    0.26950,    0.89086,    8.73328,    0.02798,    0.11270,    0.16027,    0.13783,
#                      0.05105,    0.85937,    0.80662,    0.59525,    0.74255,    0.89817,    8.09508,    0.12638,
#                      0.21415,    0.96650,    0.12495,    0.88526,    0.09146,    0.42899,    0.70579,    0.25391,
#                      0.41425,    0.11668,    0.07310,    0.23312,    0.50665,    0.10344,    0.75825,    0.71842,
#                      0.40381,    0.18298,    0.36077,    0.26998,    0.92945,    0.23136,    0.59756,    0.98148,
#                      0.18478,    0.35717,    0.14017,    0.74673,    0.45086,    0.09237,    0.20714,    0.71585,
#                      0.49646,    0.24563,    0.99324,    0.45483,    0.29137,    0.31014,    0.75493,    0.91689,
#                      0.95660,    0.84002,    0.18656,    0.62444,    0.20679,    0.62989,    0.14484,    0.03144,
#                      0.41225,    0.91965,    0.91157,    0.45958,    0.84885,    0.08504,    0.76278,    0.32672,
#                      0.39368,    0.79983,    0.10128,    0.68598,    0.83559,    0.21271,    0.33390,    0.11628,
#                      0.71137,    0.65598,    0.78404,    0.47902,    0.26255,    0.77631,    0.04882,    0.62668,
#                      0.34303,    0.52945,    0.80601,    0.92397,    0.14185,    0.89462,    0.01004,    0.15316,
#                      0.02876,    0.64054,    0.15996,    0.40866,    0.94214,    0.31214,    0.14124,    0.57567,
#                      0.67908,    0.43659,    0.52660,    0.61059,    0.66739,    0.60736,    0.42181,    0.06852,
#                      0.30142,    0.30690,    0.30800,    0.45645,    0.73653,    0.64136,    0.92888,    0.48359,
#                      0.45741,    0.23591,    0.07896,    0.34559,   13.91303,    0.56566,    0.17381,    0.98895,
#                      0.28075,    0.22149,    0.21180,    0.27492,    0.24944,    0.77786,    0.50302,    8.25382,
#                      0.50928,    0.22889,    0.26443,    0.81160,    0.62592,    0.56823,    0.37586,    0.06454,
#                      0.19488,    0.31179,    0.15198,    0.81571,    0.79824,    0.02611,    0.21241,    0.98750,
#                      0.69514,    0.26780,    0.56631,    0.98667,    0.59943,    0.00309,    0.84204,    0.21672,
#                      0.93846,    0.90865,    0.01556,    0.45905,    0.34803,    0.32157,    0.94343,    0.62096,
#                      0.49086,    0.92539,    0.60237,    0.12542,    0.78568,    0.70110,    0.51186,    0.72851,
#                      0.85708,    0.34506,    0.22070,    0.00386,    0.08566,    0.59610,    0.97948,    0.56980,
#                      0.76479,    0.55984,    0.84063,    0.46915,    0.48015,    0.35191,    0.73344,    0.16073,
#                      0.18566,    0.80631,    0.99631,    0.17507,    0.78418,    0.67018,    0.54158,    0.59866,
#                      0.29096,    0.52003,    0.16887,    0.80251,    0.04077,    0.21190,    0.65894,    0.71938,
#                      0.15865,    0.45670,    0.39790,    0.88212,    0.81452,    0.45652,    0.82504,    0.80774,
#                      0.77313,    0.77773,    0.88256,    0.41025,    0.28867,    0.34217,    0.10101,    0.65445,
#                      0.64544,    0.44004,    0.85440,    0.93771,    0.51563,    0.77434,    0.06947,    0.55451,
#                      0.56954,    0.51177,    0.81949,    0.29058,    0.02071,    0.23019,    0.10884,    0.21713,
#                      0.28555,    0.68137,    0.06308,    0.78964,    0.90662,    8.48588,    0.13338,    0.97124,
#                      0.28128,    0.91960,    0.78790,    0.67392,    0.67800,    0.63724,    0.83277,    0.18829,
#                      11.55437,    0.49343,    0.02084,    0.98292,    0.04159,    0.49970,    0.92490,    0.83001,
#                      0.37967,    0.60845,    0.77930,    0.12143,    0.95024,    0.52538,    0.30988,    0.17887,
#                      0.04590,    0.70208,    0.88555,    0.04735,    0.97170,    0.87269,    0.30152,    0.71948,
#                      0.43896,    0.54505,    0.49488,    0.59656,    0.10639,    0.99643,    0.13154,    0.20760,
#                      0.24538,    0.42594,    0.60919,    0.32661,    0.13909,    0.66058,    0.76267,    0.12587,
#                      0.74871,    0.27353,    0.06857,    0.66941,    0.68933,    0.40911,    0.48100,    0.40839,
#                      0.29233,    0.01798,    0.45945,    0.82710,    0.84453,    0.74455,    0.82811,    0.90751,
#                      0.72218,    0.22907,    0.23105,    0.29386,    0.03299,    0.07297,    0.65535,    0.39458,
#                      0.18482,    0.10684,    0.69006,    0.03536,    0.77620,    0.07033,    0.85254,    0.44963,
#                      0.44249,    0.42462,    0.72545,    0.22172,    0.54252,    0.99930,    0.27761,    0.58339,
#                      0.37403,    0.12483,    0.66204,    0.95506,    0.26642,    0.07111,    0.75879,    0.55934,
#                      0.27706,    0.17421,    0.63632,    0.32397,    0.62688,    0.00929,    0.33517,    0.47173,
#                      0.19735,    0.25440,    0.23137,    0.13805,    0.29358,    0.57446,    0.16891,    0.17486,
#                      0.81168,    0.56355,    0.19217,    0.77762,    0.43355,    0.51899,    8.74231,    0.04208,
#                      0.63581,    0.72404,    0.20752,    0.67161,    0.49087,    0.66678,    0.53526,    0.93921,
#                      0.14829,    8.39485,    0.76900,    0.38939,    0.30797,    0.69380,    0.93981,    0.64036,
#                      0.37906,    0.54725,    0.79273,    0.92407,    0.46334,    0.15352,    0.81080,    0.31234,
#                      0.84989,    0.91849,    0.28454,    0.07828,    0.44564,    0.61013,    0.27826,    0.79339,
#                      0.35125,    0.34566,    0.37643,    0.20707,    0.75552,    0.43252,    0.67397,    0.41246,
#                      0.36061,    0.77067,    0.82372,    0.41645,    0.38525,    0.09377,    0.92424,    0.01445,
#                      0.24964,    0.30950,    0.43543,    0.93096,    0.56174,    0.51897,    0.45165,    0.61233,
#                      0.62962,    0.23426,    0.23870,    0.47391,    0.08279,    0.70883,    0.99494,    0.33809,
#                      0.19212,    0.59100,    0.26717,    0.56835,    0.32082,    0.51294,    0.65807,    0.48010,
#                      0.31026,    0.40197,    0.43840,    0.89893,    0.16454,    0.31181,    0.13842,    0.81631,
#                      0.89824,    0.73875,    0.55308,    0.16719,    0.35501,    0.49828,    0.15169,    0.70433,
#                      0.51742,    0.34092,    0.63148,    0.66503,    0.65517,    0.95970,    0.30421,    0.01801,
#                      0.37439,    0.18743,    0.29988,    0.60631,    0.95896,    0.34174,    0.99733,    0.39911,
#                      0.09226,    0.45185,    0.89540,    0.34566,    0.55707,    0.71923,    0.19182,    0.49286,
#                      0.33445,    0.07131,    0.42297,    0.43129,    0.79597,    0.01133,    0.56211,    8.72557,
#                      0.59397,    0.96041,    0.35297,    0.80701,    0.02397,    0.84990,    0.55624,    0.88276,
#                      0.58454,    0.72116,    8.29342,    0.08053,    0.68322,    0.89053,    0.15748,    0.11644,
#                      0.74621,    0.03926,    0.87751,    0.05730,    0.42855,    0.77222,    0.62937,    0.84752,
#                      0.72300,    0.70865,    0.57909,    0.11975,    0.26066,    0.32511,    0.61659,    0.23415,
#                      0.02240,    0.83902,    0.88202,    0.58408,    0.12551,    0.61981,    0.28566,    0.15060,
#                      0.64480,    0.94000,    0.78554,    0.28172,    0.83536,    0.97732,    0.77693,    0.76901,
#                      0.71192,    0.17845,    0.68893,    0.08023,    0.31377,    0.84967,    0.46194,    0.08320,
#                      0.45239,    0.14372,    0.47152,    0.89625,    0.30673,    0.83032,    0.52956,    0.83302,
#                      0.51186,    0.32895,    0.76231,    0.68038,    0.36668,    0.06482,    0.58357,    0.86842,
#                      0.02698,    0.95348,    0.93468,    0.88380,    0.08353,    0.97158,    0.22825,    0.84633,
#                      0.69256,    0.27166,    0.63432,    0.39849,    0.81319,    0.95714,    0.61430,    0.68423,
#                      0.78645,    0.46231,    0.78052,    0.82758,    0.51594,    0.09906,    0.99372,    0.96676,
#                      0.54478,    0.38459,    0.22727,    0.20587,    0.44240,    0.36964,    0.90205,    0.17188,
#                      0.55187,    0.99610,    0.21843,    0.78132,    0.97636,    0.88978,    0.28759,    0.51406,
#                      0.05120,    0.26030,    0.00131,    0.78410,    0.60316,    0.16648,    0.15094,    0.43473,
#                      8.78875,    0.52753,    0.46545,    0.95013,    0.35292,    0.61687,    0.71009,    0.78465,
#                      0.23820,    0.29654,    0.83010,    8.09434,    0.24569,    0.53284,    0.64908,    0.10107,
#                      0.43242,    0.02169,    0.21706,    0.33148,    0.77758,    0.73083,    0.31437,    0.54423,
#                      0.30026,    0.90927,    0.60095,    0.60840,    0.86495,    0.46947,    0.37314,    0.89167,
#                      0.43115,    0.34043,    0.51235,    0.93971,    0.34013,    0.77146,    0.12911,    0.18998,
#                      0.16081,    0.70305,    0.77657,    0.59798,    0.36222,    0.75020,    0.10372,    0.47000,
#                      0.44457,    0.05798,    0.68049,    0.74227,    0.36331,    0.70801,    0.19057,    0.04736,
#                      0.14542,    0.23696,    0.38687,    0.79483,    0.49170,    0.45183,    0.22816,    0.83092,
#                      0.59064,    0.87170,    0.59560,    0.21333,    0.97443,    0.24253,    0.68951,    0.34349,
#                      0.17543,    0.02265,    0.50499,    0.06743,    0.73950,    0.98350,    0.10978,    0.55272,
#                      0.81583,    0.75593,    0.81751,    0.42089,    0.53847,    0.10709,    0.05547,    0.75561,
#                      0.48261,    0.73225,    0.03328,    0.83095,    0.09975,    0.26411,    0.65159,    0.11538,
#                      0.54161,    0.09971,    0.24840,    0.34376,    0.99199,    0.22528,    0.58800,    0.89147,
#                      0.48139,    0.45749,    0.25095,    0.17768,    0.66404,    0.04633,    0.45263,    0.22793,
#                      0.62404,    0.33014,    0.71408,    0.35605,    0.50394,    0.48741,    0.75575,    0.95428,
#                      0.66236,    0.79536,    0.00319,    0.12524,    0.15554,    0.38994,    0.01801,    0.46796,
#                      0.52084,    0.71673,    0.06421,    0.80492,    8.36966,    0.91589,    0.54096,    0.34604,
#                      0.61032,    0.98681,    0.50548,    0.99665,    0.44434,    0.79609,    0.35812,    0.87599,
#                      0.50017,    0.29037,    0.08794,    0.02938,    0.72119,    0.13936,    0.94934,    0.89772,
#                      0.22071,    0.79370,    0.37970,    0.79350,    0.63759,    0.01817,    0.92606,    0.71444,
#                      0.68657,    0.91361,    0.11857,    0.14572,    0.20615,    0.04446,    0.76434,    0.19979,
#                      0.96606,    0.03424,    0.53181,    0.03459,    0.01364,    0.92605,    0.75164,    0.82889,
#                      0.96646,    0.59091,    0.15745,    0.27066,    0.51219,    0.41432,    0.13094,    0.51988,
#                      0.81029,    0.60508,    0.27121,    0.71210,    0.76494,    0.15917,    0.62312,    0.41200,
#                      0.45672,    0.31942,    0.53526,    0.24350,    0.89689,    0.60864,    0.56976,    0.58488,
#                      0.12329,    0.84833,    0.46295,    0.62916,    0.70355,    0.78838,    0.24800,    0.40638,
#                      0.82993,    0.98059,    0.16235,    0.53101,    0.86464,    0.23273,    0.67726,    0.02169,
#                      0.41828,    0.69413,    0.72323,    0.89867,    0.00666,    0.20075,    0.42341,    0.06545,
#                      0.99140,    0.90083,    0.47994,    0.74666,    0.36867,    0.14330,    0.93605,    0.19744,
#                      0.45004,    0.72188,    0.16163,    0.59613,    0.05618,    0.15809,    0.65005,    0.38586,
#                      0.35247,    0.92090,    8.85157,    0.52833,    0.66790,    0.38261,    0.27341,    0.74894,
#                      0.80119,    0.43474,    0.26773,    0.09087,    0.55951,    8.81902,    0.67411,    0.15127,
#                      0.81321,    0.99818,    0.47361,    0.05732,    0.05440,    0.23546,    0.91842,    0.96853,
#                      0.41251,    0.30757,    0.72286,    0.32235,    0.43596,    0.16056,    0.13231,    0.73978,
#                      0.14538,    0.51979,    0.79940,    0.66000,    0.29996,    0.74033,    0.42738,    0.76141,
#                      0.89570,    0.92081,    0.04213,    0.56995,    0.80538,    0.19339,    0.94511,    0.80837,
#                      0.25371,    0.05057,    0.15977,    0.06955,    0.00970,    0.01809,    0.30737,    0.95288,
#                      0.86361,    0.35174,    0.60050,    0.90623,    0.47128,    0.37581,    0.56422,    0.63380,
#                      0.10621,    0.43998,    0.43633,    0.37703,    0.15937,    0.03456,    0.92829,    0.98259,
#                      0.86450,    0.07983,    0.70096,    0.72882,    0.06969,    0.79619,    0.15399,    0.81445,
#                      0.22955,    0.64109,    0.52913,    0.04403,    0.11168,    0.43959,    0.94190,    0.32419,
#                      0.70461,    0.56591,    0.83883,    0.15249,    0.37261,    0.99893,    0.57496,    0.73703,
#                      0.05708,    0.86895,    0.53691,    0.78671,    0.47400,    0.45574,    0.81661,    0.65510,
#                      0.06249,    0.75644,    0.94035,    0.24743,    0.58775,    0.08179,    0.20769,    0.40918,
#                      0.05149,    0.59233,    0.38418,    0.94767,    0.40522,    0.06346,    0.79694,    0.38958,
#                      0.44968,    0.45492,    0.94359,    8.85374,    0.41015,    0.74741,    0.41969,    0.81110,
#                      0.79946,    0.49500,    0.09164,    0.88478,    0.47842,    0.67052,    0.82374,    0.10576,
#                      0.43968,    0.22823,    0.76403,    0.95874,    0.32679,    0.87107,    0.58244,    0.14863,
#                      0.69722,    0.62853,   -2.00515,    0.52854,    0.02848,    0.63980,    0.60695,    0.48047,
#                      0.44925,    0.00939,    0.04707,    0.36945,    0.04491,    0.80156,    0.14096,    0.45283,
#                      0.39572,    0.14768,    0.48269,    0.57304,    0.77467,    0.65643,    0.57472,    0.05631,
#                      0.18792,    0.45527,    0.57712,    0.77502,    0.76985,    0.43767,    0.92996,    0.47475,
#                      0.25656,    0.70372,    0.58827,    0.59044,    0.37880,    0.18544,    0.04020,    0.68618,
#                      0.80915,    0.25466,    0.05850,    0.75434,    0.01398,    0.28469,    0.37772,    0.41109,
#                      0.49796,    0.02678,    0.35879,    0.76657,    0.87208,    0.74961,    0.11721,    0.73542,
#                      0.51364,    0.59284,    0.62132,    0.56001,    0.38204,    0.06201,    0.84133,    0.30888,
#                      0.63000,    0.85759,    0.57382,    0.04057,    0.60318,    0.78979,    0.35866,    0.69027,
#                      0.20584,    0.94213,    0.67975,    0.94983,    0.32891,    0.54046,    0.54292,    0.09238,
#                      0.21977,    0.59055,    0.81570,    0.39318,    0.57223,    0.62051,    0.58039,    0.53808,
#                      0.64988,    0.62057,    0.57613,    0.62425,    0.11958,    0.43870,    0.47647,    0.12566,
#                      0.58883,    0.03753,    0.35327,    0.54154,    8.96078,    0.26898,    0.09697,    0.88066,
#                      0.83887,    0.00879,    0.73489,    0.14313,    0.91515,    0.92804,    0.57323,    5.36694,
#                      0.73675,    0.37697,    0.49263,    0.86585,    0.79449,    0.53104,    0.57565,    0.03924,
#                      0.19305,    0.41072,    0.31136,    0.68538,    0.05464,    0.57504,    0.18413,    0.41380,
#                      0.39582,    0.44707,    0.79045,    0.83497,    0.37627,    0.58076,    0.80799,    0.28740,
#                      0.09940,    0.37530,    0.48598,    0.80533,    0.52863,    0.38378,    0.64624,    0.97195,
#                      0.41401,    0.45348,    0.29574,    0.98287,    0.11765,    0.21454,    0.88715,    0.28245,
#                      0.58811,    0.31512,    0.70104,    0.21242,    0.96732,    0.76459,    0.18028,    0.03213,
#                      0.66222,    0.71905,    0.82666,    0.92921,    0.41742,    0.30730,    0.39884,    0.94566,
#                      0.73405,    0.92883,    0.87678,    0.38588,    0.73689,    0.74803,    0.36897,    0.44296,
#                      0.57116,    0.03314,    0.25149,    0.11172,    0.35919,    0.66736,    0.54074,    0.44695,
#                      0.62746,    0.98569,    0.29430,    0.41188,    0.02561,    0.53059,    0.00311,    0.36874,
#                      0.05705,    0.90674,    0.02452,    0.77775,    0.35716,    0.98764,    0.99478,    0.76482,
#                      0.59376,    0.17029,    0.10382,    0.79658,    0.00892,    0.28215,    0.14567,    0.18449,
#                      0.03274,    0.63881,    0.65990,    0.89727,    0.43747,    0.67325,    0.75189,    0.57326,
#                      0.56659,    0.18759,    0.06218,    0.01805,    0.88160,   10.83546,    0.28012,    0.50686,
#                      0.82691,    0.05311,    0.43345 ])


weights = np.array([0.65733,    0.65567,    0.30767,    0.72555,    0.47153,    0.93255,    0.34025,    0.66441,
                    0.37287,    0.43995,    0.80917,    0.83721,    0.32875,    0.68657,    3.81880,    0.55463,
                    0.76862,    2.07385,    4.05816,    2.65475,    2.69768,    0.00803,    0.18749,    0.42168,
                    0.18590,    0.53679,    0.22325,    0.32030,    0.40207,    0.75043,    0.48403,    0.90438,
                    0.03740,    0.38762,    0.61375,    0.56872,    0.81614,    0.38316,    9.35577,    0.71510,
                    4.10776,    2.32615,    0.68062,    6.11326,    0.43748,    2.35603,    0.36670,    0.27752,
                    0.85525,    0.70400,    0.72678,    0.77959,    0.33765,    0.41919,    0.56275,    0.11081,
                    0.02615,    0.81829,    0.69003,    0.72356,    6.05867,    0.53842,    9.20636,    4.55063,
                    3.70819,    4.62878,    0.42373,    2.25380,    0.40611,    2.34220,    0.36336,    2.13050,
                    2.12193,    0.29766,    0.60043,    0.16849,    0.28133,    0.18790,    0.26668,    0.12540,
                    0.01705,    0.49856,    0.18997,    0.35269,    2.80502,    0.58039,    3.80939,    2.62493,
                    2.48682,    0.54667,    0.99193,    0.76809,    0.31869,    0.94755,    0.17043,    1.93550,
                    2.53176,    0.53191,    4.06076,    0.05953,    4.64629,    0.75043,    0.45833,    0.12694,
                    0.02060,    0.47663,    0.76089,    0.76560,    0.88662,    4.43096,    6.29270,    6.17838,
                    0.99827,    1.89997,    0.07006,    1.86218,    0.55288,    0.53315,    0.86595,    2.46119,
                    0.22554,    2.51765,    1.97210,    0.95177,    2.30035,    0.15862,    2.25197,    0.13099,
                    2.25123,    0.04882,    0.75930,    2.14471,    0.45959,    6.02398,    1.90041,    6.12965,
                    0.83742,    6.26715,    0.91599,    2.40903,    0.71018,    2.07532,    0.20265,    0.29012,
                    0.82377,    0.63148,    2.09740,    0.11659,    2.47323,    0.04250,    0.90775,    0.21660,
                    4.29644,    0.51779,    2.06845,    2.17998,    0.54392,    2.04710,    1.92572,    2.55663,
                    0.85666,    3.85507,    0.52057,    2.34110,    0.40662,    2.53995,    0.95832,    3.89367,
                    2.42508,    4.15641,    9.17120,    0.80148,    2.63738,    0.62027,    2.00695,    0.94313,
                    0.72646,    0.77259,    1.89924,    2.53509,    0.63229,    2.17437,    1.84232,    4.18224,
                    0.49105,    4.52994,    0.76393,    0.31277,    2.39442,    0.39377,    0.14802,    0.17818,
                    2.41517,    0.45926,   11.27470,    0.78486,    0.31641,    0.14629,    4.46926,    0.40336,
                    2.23496,    0.03687,    0.96480,    0.32925,    0.73257,    2.43696,    0.31273,    8.16422,
                    0.20040,    0.38493,    0.64122,    0.84968,    0.40556,    0.08618,    3.79143,    0.97765,
                    0.44146,    0.67289,    2.50557,    0.59120,    0.83032,    0.80634,    0.03709,    0.42212,
                    0.41890,    2.52216,    0.29613,    1.95322,    0.64044,    0.56452,    0.58397,    3.84191,
                    2.24331,    0.72327,    0.84667,    0.06929,    0.30849,    0.34266,    2.31509,    0.35084,
                    2.13831,    0.97091,    4.50807,    0.57452,    0.34854,    0.99389,    0.73878,    0.45195,
                    0.93840,    0.60004,    0.70961,    4.23457,    0.23040,    1.88282,    0.38842,    2.76122,
                    2.46925,    4.01944,    0.89992,    0.49397,    0.42835,    0.60694,    0.33884,    0.07808,
                    2.47322,    0.45730,    0.34235,    0.38207,    3.98388,    0.09375,    0.31288,    0.10694,
                    0.71596,    0.95477,    0.31723,    0.97742,    0.85765,    3.86325,    0.09215,    4.46469,
                    1.86511,    2.63069,    0.29361,    0.19568,    1.83757,    0.56341,    0.83849,    0.60634,
                    0.53838,    2.11281,    0.62184,    3.95206,    0.63947,    0.80306,    2.33897,    2.21742,
                    0.41874,    0.70643,    0.79264,    0.48810,    0.76408,    1.87238,    0.98105,    2.70251,
                    2.61740,    0.11609,    0.49947,    0.08942,    1.88926,    0.97802,    2.76253,    0.18986,
                    0.04128,    0.84375,    0.87118,    2.52181,    0.71933,    2.38947,    0.80079,    2.44188,
                    0.39443,    0.65259,    0.27368,    0.92422,    0.77296,    2.63696,    0.03300,    1.89796,
                    4.05511,    0.08566,    2.51004,    0.76250,    0.19387,    0.80759,    4.52492,    0.17677,
                    0.02669,    0.35851,    0.59758,    0.14962,    0.96233,    1.97306,    0.15235,    3.26061,
                    0.78467,    0.80033,    0.16272,    2.06048,    0.55305,    2.09939,    0.40913,    0.29090,
                    0.24200,    4.01051,    1.93902,    0.53802,    2.57129,    0.56702,    2.49922,    0.10907,
                    2.81696,    0.54100,    1.96819,    2.26658,    0.38160,    4.53515,    0.53726,    4.37852,
                    2.31594,    2.64226,    0.58127,    0.27719,    2.07439,    0.95761,    0.92283,    0.06561,
                    0.92944,    6.07982,    4.12864,    0.02477,    4.26668,    0.68565,    0.43281,    0.10022,
                    0.04648,    0.03823,    0.48975,    4.46453,    0.88292,    5.61893,    0.06135,    9.46318,
                    6.19860,    4.34951,    4.25028,    4.45021,    0.92476,    3.91697,    0.16093,    0.64397,
                    0.50957,    0.51629,    2.71000,    0.59730,    3.89986,    0.81317,    8.15273,    0.76684,
                    4.05941,    0.62363,    6.43247,    0.02436,    6.24890,    0.61489,    2.64095,    4.01092,
                    2.39977,    0.26419,    2.16711,    0.65468,    3.73642,    2.32218,    2.31418,    2.63920,
                    0.53553,    2.40517,    2.50219,    0.82903,    0.60716,    0.78454,    0.55986,    0.62386,
                    0.74256,    0.90445,    0.79442,    0.58940,    0.85825,    0.77438,    2.49409,    5.43325,
                    0.81282,    4.39587,    0.05723,    2.24568,    0.43012,    0.25776,    2.38485,    0.02288,
                    2.40059,    2.03495,    0.27336,    0.59092,    0.78258,    1.93251,    0.14996,    0.17673,
                    0.20266,    0.00233,    0.54512,    0.12065,    0.29557,    0.17360,    0.20251,    3.91212,
                    0.08721,    0.11356,    0.78478,    4.47723,    0.60484,    0.00381,    4.29664,    0.47599,
                    3.98577,    2.12357,    0.31434,    0.78096,    0.75016,    2.19901,    0.44246,    2.21504,
                    0.02193,    0.82968,    0.73465,    0.06946,    0.06256,    0.61941,    0.47181,    4.65416,
                    0.51092,    0.79473,    0.23918,    0.09210,    2.41034,    0.22999,    4.65081,    0.46982,
                    2.04666,    4.17364,    2.66747,    4.15313,    0.59925,    0.21411,    0.39086,    4.38155,
                    0.10018,    0.50960,    0.65172,    0.48230,    0.10482,    0.34057,    0.51745,    4.37441,
                    0.20703,    0.95539,    3.67986,    0.21214,    2.80947,    0.67985,    0.09531,    0.47554,
                    0.85903,    0.12915,    0.21011,    2.65779,    0.56548,    4.48687,    0.45594,    4.50965,
                    2.66099,    4.34938,    2.26350,    4.15863,    0.00067,    0.80417,    0.11079,    2.44912,
                    1.92655,    0.71134,    2.67575,    0.47273,    0.90318,    0.74518,    0.77832,    0.00151,
                    0.72040,    0.05834,    0.08203,    0.52367,    0.16610,    0.38069,    0.04249,    0.91559,
                    0.66780,    2.70549,    2.68875,    3.99678,    2.23754,   -4.37825,    0.66168,   -1.63579,
                    4.46376,    0.06202,    4.14921,    0.77916,    0.87369,    0.85546,    0.46557,    0.81423,
                    0.75833,    0.11201,    0.84773,    0.00575,    0.16847,   -3.52143,    0.47681,    0.00351,
                    0.54557,    0.19002,    0.38219,    0.84343,    2.27995,    0.57101,    0.57808,    2.34185,
                    0.59900,    0.75996,    5.77868,    0.37583,    2.01677,    0.81719,    0.51066,    0.51232,
                    0.82461,    0.11503,    0.90183,    0.12874,    0.51515,    0.32605,    0.71925,    0.23645,
                    0.11767,    0.98056,    0.03644,    0.76463,    0.84676,    0.94938,    0.13513,    1.86161,
                    0.65769,    2.05557,    2.52622,    0.90263,    3.93551,    0.15149,    0.26316,    0.27490,
                    0.83391,    0.00737,    0.96880,    0.10583,    0.61554,    0.40188,    0.35473,    0.74530,
                    0.50785,    0.81839,    0.60674,    0.86126,    0.49972,    0.31839,    0.32386,    0.30114,
                    0.79203,    4.49872,    0.91387,    0.45139,    3.77552,    0.48785,    4.36628,    2.15713,
                    2.55448,    0.49739,    2.23415,    0.67218,    4.19092,    0.78639,    2.41058,    0.53453,
                    2.23594,    0.74818,    0.49292,    2.75871,    0.74547,    0.39513,    0.76134,    0.78670,
                    0.65369,    0.20416,    0.97299,    0.20228,    0.13796,    0.15693,    2.80093,    2.54877,
                    0.89021,    2.63516,    0.36958,    0.53501,    0.70552,    0.55239,    0.90277,    0.78365,
                    0.48666,    0.80046,    0.19082,    2.70046,    0.60238,    2.47139,    0.66049,    0.18343,
                    0.72253,    0.91220,    0.49904,    4.20616,    0.18429,    0.14598,    0.57334,    1.99107,
                    0.89399,    3.96137,    0.42784,    0.80564,    2.24139,    0.57658,    0.04311,    0.49390,
                    2.43802,    0.47536,    0.02232,    0.27379,    0.08839,    1.93806,    0.46574,    0.77492,
                    0.06115,    0.81120,    0.61301,    4.10761,    4.31516,    0.54645,    0.85040,    0.34424,
                    0.97785,    2.53209,    0.12684,    0.13782,    0.54367,    0.41520,    4.17296,    0.61857,
                    4.59153,    4.54793,    1.97728,    4.42256,    2.38786,    4.40505,    1.87719,    0.56774,
                    0.33821,    0.58167,    0.99605,    2.44493,    2.04061,    3.85644,    0.26647,    0.91659,
                    0.46214,    0.14829,    0.39622,    1.91789,    0.22923,    0.87946,    0.02726,    0.63977,
                    2.52733,    0.43352,    2.64952,    2.17988,    0.73696,    3.90796,    3.95769,    2.77562,
                    6.44716,    2.41379,    5.64822,    0.03426,    3.90361,    4.20110,    1.89907,    7.44164,
                    2.77980,    6.09205,    0.80656,    0.94779,    2.64998,    0.68837,    0.49464,    0.91184,
                    0.24706,    0.11037,    0.45767,    0.88384,    0.15643,    3.94764,    0.22032,    4.16071,
                    4.23791,    5.79273,    0.20206,    0.83496,    0.47744,    0.02119,    4.51310,    2.39294,
                    3.64212,    4.18503,    5.90051,    0.09054,    4.43825,    0.45123,    0.10983,    0.83413,
                    0.42198,    0.64169,    0.71669,    0.92463,    0.14284,    0.65184,    2.52543,    2.32390,
                    3.86668,    3.83848,    2.58147,    5.67968,    0.88141,    2.20363,    2.42094,    1.86070,
                    0.22636,    2.26989,    0.43949,    0.83853,    0.38844,    0.61751,    0.11556,    0.66015,
                    0.79579,    0.21280,    0.34647,    0.04952,    0.91718,    0.08637,    0.57291,    0.96878,
                    2.41237,    0.62751,    0.50329,    2.50039,    1.98068,    0.53407,    4.41634,    2.17898,
                    3.79843,    0.45911,    0.68274,    0.84866,    0.24329,    0.31364,    0.09465,    0.30075,
                    0.86537,    0.83754,    0.04853,    0.89726,    0.79535,    0.38454,    0.28908,    0.94672,
                    4.03098,    6.26365,    1.84491,    2.78092,    0.75205,    6.12801,    1.96602,    2.62913,
                    3.94428,    0.28400,    4.17941,    0.94948,    4.39701,    0.39532,    0.51622,    0.52015,
                    0.73268,    0.48058,    0.88001,    0.67756,    0.56375,    0.33219,    0.42502,    2.18693,
                    0.85152,    3.70986,    0.17236,    2.11330,    0.42344,    4.45215,    0.75985,    0.70700,
                    0.22260,    0.93615,    0.07532,    2.27870,    0.75500,    1.95284,    2.36653,    0.29830,
                    0.65718,    2.35511,    0.93215,    4.51603,    0.42358,    3.78671,    0.99841,    2.08878,
                    0.73528,    0.65933,    0.98260,    2.28845,    0.91785,    0.83874,    0.51285,    0.37292,
                    0.40226,    0.77310,    0.54156,    0.08755,    0.22223,    2.45969,    0.05798,    2.48363,
                    0.32797,    0.60477,    0.89283,    0.22014,    0.96535,    0.68654,    0.94868,    0.41417,
                    0.10536,    0.64443,    0.41803,    3.80863,    0.35393,    0.71204,    0.16123,    0.37135,
                    0.65506,    0.96341,    0.46457,    0.17536,    0.03689,    0.81494,    0.48344,    2.49883,
                    0.36447,    0.91573,    0.99341,    0.10568,    0.53310,    0.56917,    0.95186,    0.53737,
                    0.78937,    0.90326,    0.61888,    2.65898,    0.41712,    0.59265,    0.83258,    0.85603,
                    0.39148,    0.82020,    0.09627,    0.83160,    0.72643,    0.85425,    0.39238,    0.35845,
                    2.49760,    0.59079,    2.00599,    0.67683,    0.86990,    0.72957,    0.69217,    0.31514,
                    0.26429,    0.08365,    0.97220,    2.24388,    0.04242,    0.81416,    0.78296,    0.19102,
                    0.06552,    0.61252,    0.37828,    0.28096,    0.41946,    0.73102,    0.09879,    0.83174,
                    0.99602,    0.85876,    1.91727,    0.97755,    0.44857,    0.76587,    0.94187,    0.78530,
                    0.78623,    0.69664,    0.74268,    2.24558,    0.48632,    0.08738,    0.47895,    0.75311,
                    0.80710,    0.21849,    0.65665,    0.35651,    0.13183,    0.40144,    0.36466,    0.44837,
                    0.16974,    0.32923,    2.11158,    0.57880,    0.03779,    0.69240,    0.82721,    0.59107,
                    0.00282,    0.38579,    0.24054,    0.45035,    1.92851,    0.40653,    2.09047,    0.47478,
                    0.52337,    0.55928,    0.68549,    0.21459,    0.30256,    0.14207,    0.51380,    0.74124,
                    0.30329,    0.40688,    2.63892,    1.96845,    0.02293,    0.31404,    0.40956,    0.52089,
                    0.71600,    0.86597,    0.15415,    0.79539,    0.82969,    0.29355,    4.02957,    0.25580,
                    0.76095,    0.89458,    0.21030,    0.83826,    0.05513,    0.47179,    0.12637,    0.30706,
                    0.76648,    0.37591,    0.37255,    1.86785,    0.66495,    0.59599,    0.57928,    0.15417,
                    0.41901,    0.27997,    0.93943,    0.39412,    0.91837,    0.62318,    3.73978,    0.74343,
                    0.27558,    0.60715,    0.44216,    0.64592,    0.24143,    0.34959,    0.42898,    0.10319,
                    0.83497,    0.14740,    0.65355,    0.94087,    0.45439,    2.32428,    0.04615,    4.25619,
                    0.72757,    1.87234,    0.02464,    1.83828,    4.62901,    0.84782,    2.54262,    0.39581,
                    0.05944,    0.16567,    0.23686,    0.12489,    0.72712,    0.30722,    0.25096,    0.70344,
                    0.32544,    0.73200,    0.56382,    0.79245,    0.69480,    4.34786,    0.81630,    2.27575,
                    1.98128,    2.42498,    6.13529,    0.50061,    5.81356,    0.82537,    4.22586,    0.69505,
                    8.31230,    0.62250,    4.20779,    0.51240,    2.24046,    0.22800,    0.21878,    2.78207,
                    0.64725,    2.74507,    0.19508,    2.46221,    0.69398,    2.64920,    2.36559,    2.12510,
                    0.38547,    0.75452,    2.10206,    0.16646,    0.80390,    0.69760,    0.71580,    0.20167,
                    0.82382,    0.39992,    2.72238,    0.90148,    2.75830,    0.64318,    0.07892,    2.21585,
                    0.91039,    0.50988,    0.37822,    0.06157,    0.49308,    0.36610,    2.19989,    0.36129,
                    0.35354,    0.30332,    0.49477,    0.91687,    0.87556,    0.46791,    0.32659,    0.77280,
                    0.28344,    0.67421,    0.29295,    0.23293,    0.26630,    0.75420,    0.18688,    2.52346,
                    0.15924,    0.74053,    0.92880,    0.47350,    0.23563,    0.22313,    1.90401,    0.37189,
                    3.97971,    0.63139,    0.83182,    0.03361,    0.70444,    0.39541,    0.12274,    0.42655,
                    0.64286,    0.19553,    0.61751,    0.87933,    0.30686,    0.74591,    0.07539,    3.88735,
                    0.13166,    0.75630,    0.59548,    0.31338,    0.74865,    0.15027,    0.32980,    0.63374,
                    0.84933,    2.39459,    0.59640,    4.23780,    0.05703,    3.87806,    1.87197,    0.46521,
                    4.08102,    0.18905,    3.79618,    2.06938,    0.59591,    2.26055,    0.59505,    2.72754,
                    0.53367,    0.96652,    0.05108,    0.71158,    0.70291,    0.15409,    0.73993,    0.77642,
                    0.70191,    0.09869,    0.87595,    0.97403,    0.88515,    0.77437,    0.48233,    0.04399,
                    0.22046,    0.86198,    0.09719,    0.81384,    0.77418,    6.05452,    0.94475,    0.34341,
                    0.94292,    0.14692,    0.71430,    0.38351,    0.42737,    0.78165,    0.11018,    0.80414,
                    0.07312,    0.84863,    0.06840,    0.28725,    0.27101,    0.72330,    0.70848,    0.21359,
                    0.30247,    0.33935,    0.22453,    0.72106,    0.62754,    0.09787,    0.32055,    0.78012,
                    0.50554,    0.77024,    0.60426,    0.56077,    0.96773,    0.40073,    0.07224,    0.55435,
                    0.82149,    0.56899,    0.13957,    0.99949,    0.26663,    0.48889,    0.87636,    0.20397,
                    0.21694,    0.17723,    0.73546,    0.93901,    0.48324,    0.23813,    0.56042,    0.12163,
                    0.18430,    0.58014,    0.25482,    0.94359,    0.25646,    0.63584,    0.98464,    0.78998,
                    0.19911,    0.61688,    0.24921,    0.69914,    0.30517,    0.62658,    0.62568,    0.34602,
                    0.90312,    0.78422,    0.30505,    0.30213,    0.35690,    0.60236,    0.31968,    0.63067,
                    0.21642,    0.27719,    0.23654,    0.65763,    0.37544,    0.66194,    0.79492,    0.66707,
                    0.67795,    0.49133,    0.50946])

Mat = weights.reshape((11, 11, 11), order='F')
mFlat = Mat.flatten()
print("mflat is ", mFlat)
# norm = mFlat/np.linalg.norm(mFlat)
norm = mFlat
print("norm is ", norm)
norm_thresh = np.zeros(1331)
for i in range(len(norm)):
  if norm[i] >=3:
    norm_thresh[i] = 1
  else:
    norm_thresh[i] = 0.1

print("norm thresh is ", norm_thresh)
fig = plt.figure()
ax = fig.add_subplot(111, projection='3d')
for i in range(1331):
    trajectories_z0[i][3] = norm_thresh[i]
    color = 'blue'
    if trajectories_z0[i][3] == 1:
        color = 'red'
  # color = 'red'
  # label = 'z = -0.5'
  # if i >= 9 and i < 18:
  #   color = 'blue'
  #   label = 'z = 0'
  # elif i >= 18:
  #   color = 'green'
  #   label = 'z = 0.5'
    # print(i)

    ax.scatter(
    trajectories_z0[i][0],
    trajectories_z0[i][1],
    trajectories_z0[i][2],
    s=trajectories_z0[i][3] * 10,
    marker="o", color=color
  )
ax.legend(loc=8, framealpha=1, fontsize=8)
ax.set_xlabel('X Position')
ax.set_ylabel('Y Position')
ax.set_zlabel('Z Position')
plt.title('Distribution of Reward Function for a custom trajectory')
fig.savefig("/home/vignesh/Desktop/grid11_3d_suture_plot")
# plt.ion()
plt.show()